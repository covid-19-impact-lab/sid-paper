\subsection{Shapley Values} % (fold)
\label{sub:shapley_value}

We decompose the effects of different NPIs and seasonality on the infection rates with
Shapley values. Shapley values \citep{Shapley2016} are a concept in game theory to
divide payoffs between a coalition of players. It allows to assign a single value to the
contribution of an NPI or seasonality which takes into account substitutional and
complementary effects with other factors.

More formally, define a coalitional game with $N$ players and a super-additive function
$\nu$ which maps subsets of $N$ to the real numbers. The function $\nu$ is also called
the characteristic function and assigns a value to a coalition. Then, the Shapley value
$\phi$ for player $i$ is

\begin{align*}
    \phi_i(\nu) = \frac{1}{|N| !} \sum_{S \subseteq N \setminus \{i\}} |S| ! (|N| - |S| - 1)! (\nu(S \cup \{i\}) - \nu(S))
\end{align*}

The last term $(\nu(S \cup \{i\}) - \nu(S))$ is the marginal contribution of player $i$
minus the coalition without player $i$. Then, compute the sum of marginal contributions
over all subsets $S$ of $N$ which do not include player $i$. Each marginal contribution
has to be multiplied by all combinations of other players in $S$ which precede $i$ and
all possible combinations of remaining players which follow player $i$ in the coalition.
To arrive at the Shapley value for player $i$, divide the sum by the total number of
combinations.

The Shapley value has some properties.

\begin{description}
  \item[Efficiency] The sum of Shapley values is equal to the value of a coalition
  formed by all players.
  \item[Symmetry] The Shapley does not depend on the label of a player but only on its
  position in the characteristic function.
  \item[Linearity] The Shapley value depends linearly on the values from the
  characteristic function $\nu$.
  \item[Dummy Axiom] The Shapley value of a player who contributes nothing to any
  coalition is 0.
\end{description}

To produce Figure~\ref{fig:2021_scenarios_decomposition} and
Figure~\ref{fig:2021_scenarios_decomposition_tests}, we calculate the Shapley values of
each factor in the comparison on the cumulative number of saved infections between the
main scenario and the scenario without any of the factors for every day. Then, we divide
up the saved infections on a particular day according to the Shapley values for the same
day which yields the daily saved infections for each factor.


% subsection shapley_value (end)